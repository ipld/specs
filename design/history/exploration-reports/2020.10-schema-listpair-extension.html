<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IPLD Specifications</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Specifications for the Inter-planetary Linked Data project">
    
    <link rel="preload" href="/assets/css/0.styles.6c77b833.css" as="style"><link rel="preload" href="/assets/js/app.dd7273d4.js" as="script"><link rel="preload" href="/assets/js/2.fa483b33.js" as="script"><link rel="preload" href="/assets/js/66.71f337d2.js" as="script"><link rel="prefetch" href="/assets/js/10.f6e8966c.js"><link rel="prefetch" href="/assets/js/11.b50c9801.js"><link rel="prefetch" href="/assets/js/12.dfda07e3.js"><link rel="prefetch" href="/assets/js/13.bc44e0a1.js"><link rel="prefetch" href="/assets/js/14.02bd3716.js"><link rel="prefetch" href="/assets/js/15.feedc362.js"><link rel="prefetch" href="/assets/js/16.1076ecbb.js"><link rel="prefetch" href="/assets/js/17.83c7ad87.js"><link rel="prefetch" href="/assets/js/18.fb0a53fa.js"><link rel="prefetch" href="/assets/js/19.6cad2206.js"><link rel="prefetch" href="/assets/js/20.e5d2b50d.js"><link rel="prefetch" href="/assets/js/21.7255bc0c.js"><link rel="prefetch" href="/assets/js/22.61d63bb5.js"><link rel="prefetch" href="/assets/js/23.20e9e9e8.js"><link rel="prefetch" href="/assets/js/24.c35c7061.js"><link rel="prefetch" href="/assets/js/25.02f56933.js"><link rel="prefetch" href="/assets/js/26.9763295a.js"><link rel="prefetch" href="/assets/js/27.d40bd431.js"><link rel="prefetch" href="/assets/js/28.666891d7.js"><link rel="prefetch" href="/assets/js/29.2196a2d1.js"><link rel="prefetch" href="/assets/js/3.ce55762f.js"><link rel="prefetch" href="/assets/js/30.806aa330.js"><link rel="prefetch" href="/assets/js/31.a448c6a4.js"><link rel="prefetch" href="/assets/js/32.0658f00c.js"><link rel="prefetch" href="/assets/js/33.6e36c0be.js"><link rel="prefetch" href="/assets/js/34.fc297eec.js"><link rel="prefetch" href="/assets/js/35.67518866.js"><link rel="prefetch" href="/assets/js/36.477e2ecf.js"><link rel="prefetch" href="/assets/js/37.5a63d481.js"><link rel="prefetch" href="/assets/js/38.e9896ca1.js"><link rel="prefetch" href="/assets/js/39.c023f51e.js"><link rel="prefetch" href="/assets/js/4.84d7103d.js"><link rel="prefetch" href="/assets/js/40.543eab40.js"><link rel="prefetch" href="/assets/js/41.c97acf8b.js"><link rel="prefetch" href="/assets/js/42.0c297929.js"><link rel="prefetch" href="/assets/js/43.24f355f4.js"><link rel="prefetch" href="/assets/js/44.be6f4b64.js"><link rel="prefetch" href="/assets/js/45.5616e444.js"><link rel="prefetch" href="/assets/js/46.178cd27a.js"><link rel="prefetch" href="/assets/js/47.931d1ebf.js"><link rel="prefetch" href="/assets/js/48.e718b233.js"><link rel="prefetch" href="/assets/js/49.6ee87e40.js"><link rel="prefetch" href="/assets/js/5.abf32d94.js"><link rel="prefetch" href="/assets/js/50.bd3c41d0.js"><link rel="prefetch" href="/assets/js/51.6b34c736.js"><link rel="prefetch" href="/assets/js/52.a71ac794.js"><link rel="prefetch" href="/assets/js/53.22cfe720.js"><link rel="prefetch" href="/assets/js/54.f191b562.js"><link rel="prefetch" href="/assets/js/55.ad506e80.js"><link rel="prefetch" href="/assets/js/56.d371d416.js"><link rel="prefetch" href="/assets/js/57.1a245a79.js"><link rel="prefetch" href="/assets/js/58.f895a993.js"><link rel="prefetch" href="/assets/js/59.d5953986.js"><link rel="prefetch" href="/assets/js/6.8e80b6bb.js"><link rel="prefetch" href="/assets/js/60.faef6b7f.js"><link rel="prefetch" href="/assets/js/61.af720eaa.js"><link rel="prefetch" href="/assets/js/62.84c72a46.js"><link rel="prefetch" href="/assets/js/63.dd894062.js"><link rel="prefetch" href="/assets/js/64.3edc5c3b.js"><link rel="prefetch" href="/assets/js/65.92f0c2f1.js"><link rel="prefetch" href="/assets/js/67.9d77d778.js"><link rel="prefetch" href="/assets/js/68.8e08e272.js"><link rel="prefetch" href="/assets/js/69.0bca181d.js"><link rel="prefetch" href="/assets/js/7.20765c01.js"><link rel="prefetch" href="/assets/js/70.0d1e90cc.js"><link rel="prefetch" href="/assets/js/71.3c62e64f.js"><link rel="prefetch" href="/assets/js/72.1cc8375e.js"><link rel="prefetch" href="/assets/js/73.4791ebfa.js"><link rel="prefetch" href="/assets/js/74.032ab4ac.js"><link rel="prefetch" href="/assets/js/75.1ea0d30b.js"><link rel="prefetch" href="/assets/js/76.7c0afe1a.js"><link rel="prefetch" href="/assets/js/77.c866cb21.js"><link rel="prefetch" href="/assets/js/78.1ecf418e.js"><link rel="prefetch" href="/assets/js/79.d9f2e81f.js"><link rel="prefetch" href="/assets/js/8.6b02f076.js"><link rel="prefetch" href="/assets/js/80.90ad9f35.js"><link rel="prefetch" href="/assets/js/81.c6dd8988.js"><link rel="prefetch" href="/assets/js/82.2c56d1cd.js"><link rel="prefetch" href="/assets/js/83.ef332e9f.js"><link rel="prefetch" href="/assets/js/84.c31cb174.js"><link rel="prefetch" href="/assets/js/85.6c4554f1.js"><link rel="prefetch" href="/assets/js/86.3e7c685c.js"><link rel="prefetch" href="/assets/js/87.aa391666.js"><link rel="prefetch" href="/assets/js/88.dbb53c4d.js"><link rel="prefetch" href="/assets/js/89.b61fc1a2.js"><link rel="prefetch" href="/assets/js/9.4dd99b27.js"><link rel="prefetch" href="/assets/js/90.dd04f094.js"><link rel="prefetch" href="/assets/js/91.932346e8.js"><link rel="prefetch" href="/assets/js/92.7e4e3238.js"><link rel="prefetch" href="/assets/js/93.9e0b9fc3.js"><link rel="prefetch" href="/assets/js/94.fae6c28d.js"><link rel="prefetch" href="/assets/js/95.1506c4a5.js"><link rel="prefetch" href="/assets/js/96.eac0aa58.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6c77b833.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">IPLD Specifications</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/schemas/" class="nav-link">
  IPLD Schemas
</a></div> <a href="https://github.com/ipld/specs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#the-idea" class="sidebar-link">The idea</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#analysis" class="sidebar-link">Analysis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#other-representations" class="sidebar-link">Other representations</a></li><li class="sidebar-sub-header"><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#selectors" class="sidebar-link">Selectors</a></li><li class="sidebar-sub-header"><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#pathing" class="sidebar-link">Pathing</a></li><li class="sidebar-sub-header"><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#codecs" class="sidebar-link">Codecs</a></li><li class="sidebar-sub-header"><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#advanced-uses" class="sidebar-link">Advanced uses</a></li></ul></li><li><a href="/design/history/exploration-reports/2020.10-schema-listpair-extension.html#relation-to-the-string-discussion" class="sidebar-link">Relation to the String discussion</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="schema-listpair-extension"><a href="#schema-listpair-extension" class="header-anchor">#</a> Schema listpair extension</h1> <p><strong>Author</strong>: Volker Mische (<a href="https://github.com/vmx" target="_blank" rel="noopener noreferrer">@vmx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <p>First of all, this idea wasn't mine, it came up during a conversation with <a href="https://github.com/ianopolous" target="_blank" rel="noopener noreferrer">@ianopolous<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. I also don't think it's a new idea, but I'm not aware that we've a written record of this.</p> <p>This idea is related to the discussion about the <a href="https://specs.ipld.io/data-model-layer/data-model.html" target="_blank" rel="noopener noreferrer">IPLD Data Model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>String</code> kind should be defined, as 8-bit byte sequence or as sequence of Unicode characters. I get into details why it can help with that discussion as well at the end of the document. Though I encourage readers to read this exploration report without that issue in mind.</p> <h2 id="the-idea"><a href="#the-idea" class="header-anchor">#</a> The idea</h2> <p>Currently the <a href="https://specs.ipld.io/schemas/" target="_blank" rel="noopener noreferrer">IPLD Schemas<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>Map</code> kind shares the same limitations in regards to the key kind as the Data Model <code>Map</code>s do. They can only be of kind <code>String</code>. There are applications where it would be convenient to be able to other kinds as well, for example the <code>Integer</code> kind.</p> <p>IPLD Schemas already support different representations for the <code>Map</code> kind. One of them is <a href="https://specs.ipld.io/schemas/representations.html#map-listpairs-representation" target="_blank" rel="noopener noreferrer"><code>listpairs</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This representation could be extended to support other kinds as well. A <code>Map</code> with <code>Integer</code> keys could look like that:</p> <div class="language-ipldsch extra-class"><pre class="language-ipldsch"><code><span class="token typedef"><span class="token keyword">type</span> <span class="token class-name">IntegerKeyedMap</span></span> <span class="token punctuation">{</span> Int<span class="token punctuation">:</span> String <span class="token punctuation">}</span> representation listpairs
</code></pre></div><p>Some data matching the <code>IntegerKeyedMap</code> Map (shown as JSON) is:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">16711680</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">65280</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="analysis"><a href="#analysis" class="header-anchor">#</a> Analysis</h2> <h3 id="other-representations"><a href="#other-representations" class="header-anchor">#</a> Other representations</h3> <p>Giving the <code>listpairs</code> representation the power of having keys with arbitrary key, makes it a special case. The other representations won't work with it.</p> <p>So for example the default <code>map</code> representation with a definition like this</p> <div class="language-ipldsch extra-class"><pre class="language-ipldsch"><code><span class="token typedef"><span class="token keyword">type</span> <span class="token class-name">IntegerKeyedMap</span></span> <span class="token punctuation">{</span> Int<span class="token punctuation">:</span> String <span class="token punctuation">}</span>
</code></pre></div><p>would need to produce an error as IPLD Data Model <code>Map</code>s only support keys with the <code>String</code> kind.</p> <p>In also applies to the <code>stringpairs</code> representation. Though that representation has already constraints that they key as well as the value need to be representable as a Data Model <code>String</code> kind.</p> <p>The different representations would support these key value pairs:</p> <table><thead><tr><th>Representation</th> <th>Key</th> <th>Value</th></tr></thead> <tbody><tr><td><code>stringpairs</code></td> <td><code>String</code></td> <td><code>String</code></td></tr> <tr><td><code>map</code></td> <td><code>String</code></td> <td>any kind</td></tr> <tr><td><code>listpairs</code></td> <td>any kind</td> <td>any kind</td></tr></tbody></table> <h3 id="selectors"><a href="#selectors" class="header-anchor">#</a> Selectors</h3> <p>Selectors operate on the Data Model and not on the Schema level. This means that making the proposed <code>listpairs</code> extension to the Schema <code>Map</code> kind won't change anything on the Selectors.</p> <p>Though this is not fully true. When thinking about Selectors, you also want to apply them to things that are expressed in the Schema, but is not necessarily reflected in the Data Model representation. An example are <code>Struct</code>s where you want to access something by the field name, even if its representation <code>tuple</code>.</p> <p>The same method can be applied to the extended <code>listpairs</code> representation for <code>Map</code>s. The Selector could be translated into a pure Data Model representation, or your implementations might have an abstraction to support iterating over such a different map representation.</p> <h3 id="pathing"><a href="#pathing" class="header-anchor">#</a> Pathing</h3> <p>Basic pathing is done in the Data Model, so no changes would be needed. In order to path over kinds other than strings, some more advanced pathing that is Schema aware would be needed. It needs to be determined whether this should be part of the basic pathing, the Selectors or something separate. Independent of this proposal, something similar would be needed in case pathing over <code>Struct</code>s should be supported (which I think should be).</p> <h3 id="codecs"><a href="#codecs" class="header-anchor">#</a> Codecs</h3> <p>Depending on the Codec, things can be similarly efficient as with Data Model <code>Map</code>s. Take CBOR as an example. Let's not think about the Data Model for a moment, but only about the Codec. In CBOR (not in <em>DAG-CBOR</em>) it's possible to have maps with integer keys:</p> <div class="language- extra-class"><pre class="language-text"><code>A3               # map(3)
   1A 00FF0000   # unsigned(16711680)
   63            # text(3)
      726564     # &quot;red&quot;
   19 FF00       # unsigned(65280)
   65            # text(5)
      677265656E # &quot;green&quot;
   18 FF         # unsigned(255)
   64            # text(4)
      626C7565   # &quot;blue&quot;
</code></pre></div><p>The same data with representation <code>listpairs</code>, which could be decoded into a valid Data Model (hence also <em>DAG-CBOR</em>), looks like this:</p> <div class="language- extra-class"><pre class="language-text"><code>
83                  # array(3)
   82               # array(2)
      1A 00FF0000   # unsigned(16711680)
      63            # text(3)
         726564     # &quot;red&quot;
   82               # array(2)
      19 FF00       # unsigned(65280)
      65            # text(5)
         677265656E # &quot;green&quot;
   82               # array(2)
      18 FF         # unsigned(255)
      64            # text(4)
         626C7565   # &quot;blue&quot;
</code></pre></div><p>You can see that the &quot;pairs&quot; add one level of indirection. So the changes are quite small.</p> <p>Though in case you want to get even closer to the native CBOR map with integers encoding, there could be a new representation be introduced, which stores the key value pairs in a flat list. So instead of…</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">16711680</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">65280</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><p>…the data would be represented as…</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token number">16711680</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token number">65280</span><span class="token punctuation">,</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>…which would then encode in CBOR as:</p> <div class="language- extra-class"><pre class="language-text"><code>86               # array(6)
   1A 00FF0000   # unsigned(16711680)
   63            # text(3)
      726564     # &quot;red&quot;
   19 FF00       # unsigned(65280)
   65            # text(5)
      677265656E # &quot;green&quot;
   18 FF         # unsigned(255)
   64            # text(4)
      626C7565   # &quot;blue&quot;
</code></pre></div><p>The only difference to the map encoding is the first byte being <code>86</code> instead of <code>A3</code>, it doesn't have any other additional bytes.</p> <h3 id="advanced-uses"><a href="#advanced-uses" class="header-anchor">#</a> Advanced uses</h3> <p>Extending the <code>listpair</code> definition would also enable other advanced uses. Let's take DAG-CBOR as an example. The Codec specifies a certain ordering on the map keys, which is needed so that the same data is always encoded the same way. IPLD implementations might preserve the ordering of the codec and not define their own.</p> <p>If that's the case, then applications could decide to impose their own custom ordering, which would also be preserved in the Codec. You could even use it from strings keys. You would manually construct the list containing the pairs on the Data Model layer.</p> <h2 id="relation-to-the-string-discussion"><a href="#relation-to-the-string-discussion" class="header-anchor">#</a> Relation to the String discussion</h2> <p>All this relates to the discussion whether Data Model Strings should be a sequence of 8-bit bytes or a sequence of Unicode characters. And related to that is the discussion whether <code>Map</code> keys <a href="https://hackmd.io/79okuu4eQoedhpmgVbZboA?view" target="_blank" rel="noopener noreferrer">should be string, bytes or something else<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. There it becomes clear that it would makes systems easier when <code>Map</code> keys could just be the same thing as string values and path segments.</p> <p>Though there is a problem. It is desirable that strings as values are Unicode-only to maximize interoperability, trading-off flexibility. Though for map keys, having the ability to use arbitrary bytes is nice in case you e.g. want to have filenames (which may contain non Unicode bytes) as keys. Having both things, &quot;don't use arbitrary bytes in strings&quot; and &quot;it's OK to have bytes in strings&quot; is a contradiction.</p> <p>With this proposal it's possible. Strings could be defined as sequence of Unicode character and disallow/discourage bytes. As a side-effect this would also enhance interoperability with Codecs that only support strings as key (e.g. Protocol Buffers) and programming languages alike.</p> <p>Though the use-case of filenames as map keys, e.g for IPFS, can still be served. You would use binary keys together with the <code>listpairs</code> representation to store the filenames.</p> <p>To me all this aligns well with:</p> <blockquote><p>&quot;Simple things should be simple, complex things should be possible.&quot;
-- <a href="https://www.quora.com/What-is-the-story-behind-Alan-Kay-s-adage-Simple-things-should-be-simple-complex-things-should-be-possible/answer/Alan-Kay-11" target="_blank" rel="noopener noreferrer">Alan Kay<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ipld/specs/edit/master/design/history/exploration-reports/2020.10-schema-listpair-extension.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/1/2020, 12:48:00 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dd7273d4.js" defer></script><script src="/assets/js/2.fa483b33.js" defer></script><script src="/assets/js/66.71f337d2.js" defer></script>
  </body>
</html>
